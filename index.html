<html>
    



    
    
    <head>
        <title>Mywebsite</title>
        <link rel="stylesheet" type="text/css" href="css.css">
        <script src="https://unpkg.com/vue"></script>
    </head>
  
        <body>
            <div id="app">
                 
                            <header>
                             
                            <img id='logo' src="img.jpg" height="100" width="100" alt="logo">
                            <a href="#">Home</a>
                         <form id="login" v-on:submit.prevent>
                                    <h1>login</h1>
                                    <label for="email">email: </label>
                                    <input required type="email" id="email" v-model='email'>
                                     <label for="password">password: </label>
                                    <input required type="password" id="password" v-model='password'>
                                     <button v-on:click ='login'>login</button>
                                    </form>
                                    <button v-on:click="logout">logout</button>
                    <a href="sellers.html">Sellers</a>
                    <br><br>
                                <div>
                     <form id="signup">
                                <h1>Sign up</h1>
                                <label for="email">email: </label>
                                <input required type="email" id="email" v-model='email1'>
                                <label for="password">password: </label>
                                <input required type="password" id="password" v-model='password1'>
                                <button v-on:click ='register'>register</button>
                                </form>
                            </div>
                            <span>{{name}}</span>
                          
                            </header>
                         
                <br><br><br><br><br><br>
                            <aside>
                            <div class="filter">
                                
                                            <h1>Filters</h1>
                                            <select multiple v-model='selectedTopic'>
                                            <option v-for='topic in topics'>
                                            {{topic}}
                                            </option>
                                            </select>
                                            <p>Select topics: {{selectedTopic}}</p>
                                            <!-- <br> -->
                                            <select multiple v-model='selectedPrice'>
                                            <option v-for="price in prices">
                                            {{price}}</option>
                                            </select>
                                            <p>Select Price: {{selectedPrice}}</p>
                
                                            
                                                    <h1>Course list</h1>
                                                    <div v-for="course in filteredCourses" class="filterc">
                                                    <li v-for='(value, name) in course'>{{name}}: {{value}}</li>
                                                    </div>
                                                    <button v-on:click="reset()">Reset</button>

                                                    <br><br>
                                                <select v-model="selected">
                                                            <option v-for="option in options" v-bind:value="option.value">
                                                            {{ option.text }}
                                                             </option>
                                                            </select>
                                                            <span>sort by Price</span>
                                                             <div v-for="course in sortedArray" class="sort">
                                                            </div>
                                                           

                                                   
                  
                    </div>
                                
                
                
                </aside>
                <br><br><br><br>
                            <main>
                                    <input type="text" v-model="searchText" placeholder="Search...">
                                    <br><br>
                                    <div v-bind:style="mainStyle" v-for="(course,i) in computedCourses" :key="i">
                                            <ul>
                                                <li>topic: {{course.topic}}</li>
                                                <li>location: {{course.location}}</li>
                                                <li>price: {{course.price}}</li>
                                                <li>reviews:{{course.reviews}}</li>
                                            </ul>
                                       
                                                   
                                   
                                        </div>
                                 </main>
                           
                            
                         
                   
         </div>

                
        
            
                
            <script>

                var app1 = new Vue({
                    el:"#app",
                    data:{
                         name:"",
                        seen:false,
                        showLogin:false,
                        email:" ",
                        password:"",
                        email1:"",
                        password1:"",
                        mainStyle:{    //style main prodyct div
                            backgroundColor:"azure",
                            border:"2px solid",
                            padding:"20px",
                            display:"inline-block",
                            margin:"20px",
                            backgroundColor:"azure",
                            message:""


                        },
                        show:false,
                            searchText: " ",
                             courses: [
                        { 'topic': 'math', 'location': 'hendon', 'price': 100,'reviews':4 },
                        { 'topic': 'history', 'location': 'colindale', 'price': 80 ,'reviews':5},
                        { 'topic': 'science', 'location': 'brent cross', 'price': 90 ,'reviews':1},
                        { 'topic': 'math', 'location': 'golders green', 'price': 120,'reviews':2 },
                        { 'topic': 'music', 'location': 'hendon', 'price': 110,'reviews':1 },
                        { 'topic': 'english', 'location': 'colindale', 'price': 90 ,'reviews':5},
                        { 'topic': 'sports', 'location': 'brent cross', 'price': 90,'reviews':4 },
                        { 'topic': 'english', 'location': 'golders green', 'price': 130 ,'reviews':4},
                        { 'topic': 'piano', 'location': 'hendon', 'price': 120 ,'reviews':4},
                        { 'topic': 'guitar', 'location': 'golders green', 'price': 140,'reviews':4 }
                    ],
                    options: [
{ text: 'higher', value: 'A' },
{ text: 'lower', value: 'B' }],
                    selected:"",
                    selectedTopic:[],
                    selectedPrice: [],
                    name:" ",
                    prices:[100,80,90,120,110,130,140]
},



             
                    methods:{
                        logout:function(){
                       localStorage.removeItem("loggedInUser");
                       alert("you are logged out");
                       this.name="";},
      login:function() {
// check if the email already exists
var users = '';
var newEmail = this.email;
var newPassword = this.password;

if (localStorage.getItem('users')) { // 'users' is an array of objects
users = JSON.parse(localStorage.getItem('users'));
};
if (users) {
if (users.some(function(user) {return (user.email === newEmail && user.password === newPassword)})) {
localStorage.loggedInUser = newEmail;
alert(newEmail+' '+'you are logged in');
return this.name = newEmail;


return;
}
else {
alert("email or password doesnt match")
}

}},

register:function(){
                            var users = '';
var newEmail = this.email1;
if (localStorage.getItem('users')) { // 'users' is an array of objects
users = JSON.parse(localStorage.getItem('users'));
};
if (users) {
if (users.some(function(user) {return user.email === newEmail})) {
alert('Email already exists!');
return;
}
users.push({'email': newEmail, 'password': this.password});
localStorage.setItem('users', JSON.stringify(users));
alert("registerd succesfully");

}
else {
users = [{'email': newEmail, 'password': this.password}];
localStorage.setItem('users', JSON.stringify(users));
alert("registered");
}},

                          
                    reset: function() {
                    this.selectedTopic = [];
                    this.selectedPrice = [];

                        }
                        
                        
                        
                        
                        
                        
                        },

         

                          
            computed:{
                computedCourses(){
                    var computed =false;
                    if(this.searchText.trim().length==0){
                        return this.courses;
                    }else{
                        return this.courses.filter(c=>
                        c.topic.toLowerCase().trim().includes(this.searchText.toLowerCase().trim())     //comapres both search and array list string and returns only those that matches 

        
                        || c.location.toLowerCase().trim().includes(this.searchText.toLowerCase().trim()) // same for the location
                        )
                    }
                },

                topics: function () { // return an array of all the topics
return [...new Set(this.courses.map(x => x.topic))]},


                     filteredCourses: function() {
var topics = this.selectedTopic, prices = this.selectedPrice;
return this.courses.filter(function(course) {
var topicMatch = false, priceMatch = false;
if (topics.length > 0) {
if (topics.includes(course.topic)) {
topicMatch = true;
}
}
else {
topicMatch = false;
}
if (prices.length >0) {
if (prices.includes(course.price.toString())) {
priceMatch = true;
}
}
else {
priceMatch = false;
}
return topicMatch && priceMatch
})
  },
 sortedArray: function(){
              if(this.selected ==="A"){
             function compare(a,b){
             return b.price-a.price}}
            if(this.selected==="B"){
                      function compare(a,b){
                        return a.price -b.price}}
                    
          
                    return this.courses.sort(compare);
  }}

})

</script>
            </body>
            </html>